<!DOCTYPE html>
<html>

<head>
    <title>Parcel Sandbox</title>
    <meta charset="UTF-8" />
    <style>
        table,
        tr,
        th,
        td {
            border: solid 1px black;
            border-collapse: collapse;
        }

        .weeklyBill {
            text-align: right;
        }
    </style>
</head>

<body>
    <div class="writeMoney">
        오늘 사용한 돈 : <input type="text" id="dailyMoney" />
        <button type="button" onclick="init()">입력</button>
    </div>
    <div class="recordMoney">
        <table>
            <thead>
                <tr>
                    <th>일요일</th>
                    <th>월요일</th>
                    <th>화요일</th>
                    <th>수요일</th>
                    <th>목요일</th>
                    <th>금요일</th>
                    <th>토요일</th>
                </tr>
            </thead>
            <tbody>
                <tr class="weeklyBill">
                    <td id="0">공백</td>
                    <td id="1">공백</td>
                    <td id="2">공백</td>
                    <td id="3">공백</td>
                    <td id="4">공백</td>
                    <td id="5">공백</td>
                    <td id="6">공백</td>
                </tr>
            </tbody>
        </table>
    </div>

    <script>
        //가계부 프로그램 만들기
        //하루에 쓴 돈을 적어서 매일 기록하는 방식
        // + 쓴 내역을 분류하여 낭비를 강조하는 기능
        // + 자동으로 사용내역을 감지하여 낭비를 줄이는 기능

        //광역 변수 
        const Sun = document.getElementById(0),
                Mon = document.getElementById(1),
                Tue = document.getElementById(2),
                Wed = document.getElementById(3),
                Thu = document.getElementById(4),
                Fri = document.getElementById(5),
                Sat = document.getElementById(6);
        //오늘 날짜 탐색
        const date = new Date();
        const today = date.getDay();
        //오늘 날짜에 맞게 일주일 가계부에 출력하기
        function recordWeekly() {
            //input 값 입력받고 출력하기
            const inputMoney = document.querySelector("#dailyMoney");
            
            //탐색한 날짜에 맞게 테이블 안에 값 넣기(더 깔끔한 표현법 알아보기)
            if (today == Sun.id) {
                document.getElementById(0).innerHTML = inputMoney.value;
            } else if (today == Mon.id) {
                document.getElementById(1).innerHTML = inputMoney.value;
            } else if (today == Tue.id) {
                document.getElementById(2).innerHTML = inputMoney.value;
            } else if (today == Wed.id) {
                document.getElementById(3).innerHTML = inputMoney.value;
            } else if (today == Thu.id) {
                document.getElementById(4).innerHTML = inputMoney.value;
            } else if (today == Fri.id) {
                document.getElementById(5).innerHTML = inputMoney.value;
            } else if (today == Sat.id) {
                document.getElementById(6).innerHTML = inputMoney.value;
            }
        }

        //입력한 값 저장 형태
        const MYBILLS = 'mybills'
        let mybills = []

        //로컬스토리지에 저장
        function saveBills() {
            localStorage.setItem(MYBILLS , JSON.stringify(mybills))
        }
        //저장된 개체에 대한 속성 부여
        function createBills() {
            //input 값 입력받고 출력하기
            let inputMoney = document.querySelector("#dailyMoney").value;
            //하루동안 쓴 돈 저장하기
            let TODAYMONEY = {
                day: today,
                money: inputMoney
            };
            mybills.push(TODAYMONEY)
            saveBills()
        }
        //저장한 값 불러오기
        function loadBill() {
            //문자열 리스트를 다시 리스트로 변경
            const loadSavedBill = localStorage.getItem(MYBILLS)
            const parsedBill = JSON.parse(loadSavedBill)
            let load_day = parsedBill[0].day
            let load_money = parsedBill[0].money
            
            if (load_day == Sun.id) {
                document.getElementById(0).innerHTML = load_money;
            } else if (load_day == Mon.id) {
                document.getElementById(1).innerHTML = load_money;
            } else if (load_day == Tue.id) {
                document.getElementById(2).innerHTML = load_money;
            } else if (load_day == Wed.id) {
                document.getElementById(3).innerHTML = load_money;
            } else if (load_day == Thu.id) {
                document.getElementById(4).innerHTML = load_money;
            } else if (load_day == Fri.id) {
                document.getElementById(5).innerHTML = load_money;
            } else if (load_day == Sat.id) {
                document.getElementById(6).innerHTML = load_money;
            }
        }
        //같은 날 갱신하는 거 방지
        function deleteLS(){
            const loadSavedBill = localStorage.getItem(MYBILLS)
            const parsedBill = JSON.parse(loadSavedBill)
            let load_day = parsedBill[0].day
            let load_money = parsedBill[0].money
            if (today == load_day) {
                localStorage.removeItem('load_day')
            }
        }
        function init() {
            recordWeekly();
            createBills();
            deleteLS()
        }
        loadBill();
    </script>
</body>

</html>